<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Admin page</title>
    <link rel="stylesheet" href="/resources/css/animate.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>

</head>
<body>

<div th:include="~{index.html :: navbar}"></div>

<div class="content">
    <div class="row">

        <div class="col-md-7">
            <table class="table">
                <thead>
                <tr>
                    <th scope="col">id</th>
                    <th scope="col">Username</th>
                    <th scope="col">Password</th>
                    <th scope="col">Blocked</th>
                    <th scope="col">Action</th>
                </tr>
                </thead>
                <tbody id="users-tr">

                </tbody>
            </table>
        </div>

    </div>

</div>

<script>
    let userPage = 0;
    initUsers();
    function initUsers() {
        fetch(`/api/admin/users?page=${userPage}`).then(response=>{
            return response.json()
        }).then(data=>{
            console.log(data);
            let str = '';
            for (let i = 0; i < data.length; i++) {
                str += `<tr class="animated fadeInUp"><th scope="row">${data[i].id}</th>
                    <td>${data[i].username}</td>
                    <td>${data[i].password}</td>
                    <td>${data[i].status}</td>
                    <td>
                        <form action="/admin/processUser/${data[i].id}" method="post">
                            <button class="${data[i].status ? 'btn btn-success' : 'btn btn-danger'}
                                    type="submit">${data[i].status ? 'Unblock' : 'Block'}
                            </button>
                        </form>
                    </td></tr>`
            }
            document.getElementById('users-tr').innerHTML = str;
        })
    }
</script>

</body>
</html>